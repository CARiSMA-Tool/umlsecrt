package malware;

import java.io.File;
import java.io.IOException;
import java.net.MalformedURLException;
import java.net.URL;
import java.net.URLClassLoader;

import org.gravity.security.annotations.requirements.Integrity;
import org.gravity.security.annotations.requirements.Secrecy;

import secret.Secret;

public class MalwareMethodCall {
	
	public static void main(String[] args) throws ClassNotFoundException, MalformedURLException {
		File folder = new File("malware/");
		if(!folder.exists()) {
			folder = new File("../examples/Classloader/malware");
		}
		URL url = folder.toURI().toURL();
		try(URLClassLoader loader = new URLClassLoader(new URL[] {url})){
			loader.loadClass("tests.MethodCall").newInstance();
		} catch (IOException e) {
			e.printStackTrace();
		} catch (InstantiationException e) {
			e.printStackTrace();
		} catch (IllegalAccessException e) {
			e.printStackTrace();
		}
	}
	
	@Secrecy @Integrity
	private static String secret() {
		return Secret.secret();
	}
}
